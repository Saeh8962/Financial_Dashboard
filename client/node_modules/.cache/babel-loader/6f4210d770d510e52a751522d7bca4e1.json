{"ast":null,"code":"import { drawing as draw } from '@progress/kendo-drawing';\nimport BoxElement from './box-element';\nimport TextBox from './text-box';\nimport ShapeElement from './shape-element';\nimport Box from './box';\nimport { CIRCLE, TOP, BOTTOM, LEFT, RIGHT, CENTER, INSIDE, OUTSIDE, NOTE_CLICK, NOTE_HOVER, NOTE_LEAVE } from '../common/constants';\nimport { alignPathToPixel, defined, deepExtend, eventElement, getTemplate, inArray, setDefaultOptions } from '../common';\nvar DEFAULT_ICON_SIZE = 7;\nvar DEFAULT_LABEL_COLOR = \"#fff\";\n\nvar Note = function (BoxElement) {\n  function Note(fields, options, chartService) {\n    BoxElement.call(this, options);\n    this.fields = fields;\n    this.chartService = chartService;\n    this.render();\n  }\n\n  if (BoxElement) Note.__proto__ = BoxElement;\n  Note.prototype = Object.create(BoxElement && BoxElement.prototype);\n  Note.prototype.constructor = Note;\n\n  Note.prototype.hide = function hide() {\n    this.options.visible = false;\n  };\n\n  Note.prototype.show = function show() {\n    this.options.visible = true;\n  };\n\n  Note.prototype.render = function render() {\n    var this$1 = this;\n    var options = this.options;\n\n    if (options.visible) {\n      var label = options.label;\n      var icon = options.icon;\n      var box = new Box();\n\n      var childAlias = function childAlias() {\n        return this$1;\n      };\n\n      var size = icon.size;\n      var text = this.fields.text;\n      var width, height;\n\n      if (defined(label) && label.visible) {\n        var noteTemplate = getTemplate(label);\n\n        if (noteTemplate) {\n          text = noteTemplate(this.fields);\n        } else if (label.format) {\n          text = this.chartService.format.auto(label.format, text);\n        }\n\n        if (!label.color) {\n          label.color = label.position === INSIDE ? DEFAULT_LABEL_COLOR : icon.background;\n        }\n\n        this.label = new TextBox(text, deepExtend({}, label));\n        this.label.aliasFor = childAlias;\n\n        if (label.position === INSIDE && !defined(size)) {\n          if (icon.type === CIRCLE) {\n            size = Math.max(this.label.box.width(), this.label.box.height());\n          } else {\n            width = this.label.box.width();\n            height = this.label.box.height();\n          }\n\n          box.wrap(this.label.box);\n        }\n      }\n\n      icon.width = width || size || DEFAULT_ICON_SIZE;\n      icon.height = height || size || DEFAULT_ICON_SIZE;\n      var marker = new ShapeElement(deepExtend({}, icon));\n      marker.aliasFor = childAlias;\n      this.marker = marker;\n      this.append(marker);\n\n      if (this.label) {\n        this.append(this.label);\n      }\n\n      marker.reflow(new Box());\n      this.wrapperBox = box.wrap(marker.box);\n    }\n  };\n\n  Note.prototype.reflow = function reflow(targetBox) {\n    var ref = this;\n    var options = ref.options;\n    var label = ref.label;\n    var marker = ref.marker;\n    var wrapperBox = ref.wrapperBox;\n    var center = targetBox.center();\n    var length = options.line.length;\n    var position = options.position; // TODO: Review\n\n    if (options.visible) {\n      var lineStart, box, contentBox;\n\n      if (inArray(position, [LEFT, RIGHT])) {\n        if (position === LEFT) {\n          contentBox = wrapperBox.alignTo(targetBox, position).translate(-length, targetBox.center().y - wrapperBox.center().y);\n\n          if (options.line.visible) {\n            lineStart = [targetBox.x1, center.y];\n            this.linePoints = [lineStart, [contentBox.x2, center.y]];\n            box = contentBox.clone().wrapPoint(lineStart);\n          }\n        } else {\n          contentBox = wrapperBox.alignTo(targetBox, position).translate(length, targetBox.center().y - wrapperBox.center().y);\n\n          if (options.line.visible) {\n            lineStart = [targetBox.x2, center.y];\n            this.linePoints = [lineStart, [contentBox.x1, center.y]];\n            box = contentBox.clone().wrapPoint(lineStart);\n          }\n        }\n      } else {\n        if (position === BOTTOM) {\n          contentBox = wrapperBox.alignTo(targetBox, position).translate(targetBox.center().x - wrapperBox.center().x, length);\n\n          if (options.line.visible) {\n            lineStart = [center.x, targetBox.y2];\n            this.linePoints = [lineStart, [center.x, contentBox.y1]];\n            box = contentBox.clone().wrapPoint(lineStart);\n          }\n        } else {\n          contentBox = wrapperBox.alignTo(targetBox, position).translate(targetBox.center().x - wrapperBox.center().x, -length);\n\n          if (options.line.visible) {\n            lineStart = [center.x, targetBox.y1];\n            this.linePoints = [lineStart, [center.x, contentBox.y2]];\n            box = contentBox.clone().wrapPoint(lineStart);\n          }\n        }\n      }\n\n      if (marker) {\n        marker.reflow(contentBox);\n      }\n\n      if (label) {\n        label.reflow(contentBox);\n\n        if (marker) {\n          if (options.label.position === OUTSIDE) {\n            label.box.alignTo(marker.box, position);\n          }\n\n          label.reflow(label.box);\n        }\n      }\n\n      this.contentBox = contentBox;\n      this.targetBox = targetBox;\n      this.box = box || contentBox;\n    }\n  };\n\n  Note.prototype.createVisual = function createVisual() {\n    BoxElement.prototype.createVisual.call(this);\n    this.visual.options.noclip = this.options.noclip;\n\n    if (this.options.visible) {\n      this.createLine();\n    }\n  };\n\n  Note.prototype.renderVisual = function renderVisual() {\n    var this$1 = this;\n    var options = this.options;\n    var customVisual = options.visual;\n\n    if (options.visible && customVisual) {\n      this.visual = customVisual(Object.assign(this.fields, {\n        sender: this.getSender(),\n        rect: this.targetBox.toRect(),\n        options: {\n          background: options.background,\n          border: options.background,\n          icon: options.icon,\n          label: options.label,\n          line: options.line,\n          position: options.position,\n          visible: options.visible\n        },\n        createVisual: function createVisual() {\n          this$1.createVisual();\n          this$1.renderChildren();\n          var defaultVisual = this$1.visual;\n          delete this$1.visual;\n          return defaultVisual;\n        }\n      }));\n      this.addVisual();\n    } else {\n      BoxElement.prototype.renderVisual.call(this);\n    }\n  };\n\n  Note.prototype.createLine = function createLine() {\n    var options = this.options.line;\n\n    if (this.linePoints) {\n      var path = draw.Path.fromPoints(this.linePoints, {\n        stroke: {\n          color: options.color,\n          width: options.width,\n          dashType: options.dashType\n        }\n      });\n      alignPathToPixel(path);\n      this.visual.append(path);\n    }\n  };\n\n  Note.prototype.click = function click(widget, e) {\n    var args = this.eventArgs(e);\n\n    if (!widget.trigger(NOTE_CLICK, args)) {\n      e.preventDefault();\n    }\n  };\n\n  Note.prototype.over = function over(widget, e) {\n    var args = this.eventArgs(e);\n\n    if (!widget.trigger(NOTE_HOVER, args)) {\n      e.preventDefault();\n    }\n  };\n\n  Note.prototype.out = function out(widget, e) {\n    var args = this.eventArgs(e);\n    widget.trigger(NOTE_LEAVE, args);\n  };\n\n  Note.prototype.eventArgs = function eventArgs(e) {\n    var options = this.options;\n    return Object.assign(this.fields, {\n      element: eventElement(e),\n      text: defined(options.label) ? options.label.text : \"\",\n      visual: this.visual\n    });\n  };\n\n  return Note;\n}(BoxElement);\n\nsetDefaultOptions(Note, {\n  icon: {\n    visible: true,\n    type: CIRCLE\n  },\n  label: {\n    position: INSIDE,\n    visible: true,\n    align: CENTER,\n    vAlign: CENTER\n  },\n  line: {\n    visible: true\n  },\n  visible: true,\n  position: TOP,\n  zIndex: 2\n});\nexport default Note;","map":{"version":3,"sources":["/Users/samehrlich/Desktop/final-app/node_modules/@progress/kendo-charts/dist/es/core/note.js"],"names":["drawing","draw","BoxElement","TextBox","ShapeElement","Box","CIRCLE","TOP","BOTTOM","LEFT","RIGHT","CENTER","INSIDE","OUTSIDE","NOTE_CLICK","NOTE_HOVER","NOTE_LEAVE","alignPathToPixel","defined","deepExtend","eventElement","getTemplate","inArray","setDefaultOptions","DEFAULT_ICON_SIZE","DEFAULT_LABEL_COLOR","Note","fields","options","chartService","call","render","__proto__","prototype","Object","create","constructor","hide","visible","show","this$1","label","icon","box","childAlias","size","text","width","height","noteTemplate","format","auto","color","position","background","aliasFor","type","Math","max","wrap","marker","append","reflow","wrapperBox","targetBox","ref","center","length","line","lineStart","contentBox","alignTo","translate","y","x1","linePoints","x2","clone","wrapPoint","x","y2","y1","createVisual","visual","noclip","createLine","renderVisual","customVisual","assign","sender","getSender","rect","toRect","border","renderChildren","defaultVisual","addVisual","path","Path","fromPoints","stroke","dashType","click","widget","e","args","eventArgs","trigger","preventDefault","over","out","element","align","vAlign","zIndex"],"mappings":"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","sourcesContent":["import { drawing as draw } from '@progress/kendo-drawing';\n\nimport BoxElement from './box-element';\nimport TextBox from './text-box';\nimport ShapeElement from './shape-element';\nimport Box from './box';\n\nimport { CIRCLE, TOP, BOTTOM, LEFT, RIGHT, CENTER, INSIDE, OUTSIDE, NOTE_CLICK, NOTE_HOVER, NOTE_LEAVE } from '../common/constants';\nimport { alignPathToPixel, defined, deepExtend, eventElement, getTemplate, inArray, setDefaultOptions } from '../common';\n\nvar DEFAULT_ICON_SIZE = 7;\nvar DEFAULT_LABEL_COLOR = \"#fff\";\n\nvar Note = (function (BoxElement) {\n    function Note(fields, options, chartService) {\n        BoxElement.call(this, options);\n\n        this.fields = fields;\n        this.chartService = chartService;\n\n        this.render();\n    }\n\n    if ( BoxElement ) Note.__proto__ = BoxElement;\n    Note.prototype = Object.create( BoxElement && BoxElement.prototype );\n    Note.prototype.constructor = Note;\n\n    Note.prototype.hide = function hide () {\n        this.options.visible = false;\n    };\n\n    Note.prototype.show = function show () {\n        this.options.visible = true;\n    };\n\n    Note.prototype.render = function render () {\n        var this$1 = this;\n\n        var options = this.options;\n\n        if (options.visible) {\n            var label = options.label;\n            var icon = options.icon;\n            var box = new Box();\n            var childAlias = function () { return this$1; };\n            var size = icon.size;\n            var text = this.fields.text;\n            var width, height;\n\n            if (defined(label) && label.visible) {\n                var noteTemplate = getTemplate(label);\n                if (noteTemplate) {\n                    text = noteTemplate(this.fields);\n                } else if (label.format) {\n                    text = this.chartService.format.auto(label.format, text);\n                }\n\n                if (!label.color) {\n                    label.color = label.position === INSIDE ? DEFAULT_LABEL_COLOR : icon.background;\n                }\n\n                this.label = new TextBox(text, deepExtend({}, label));\n                this.label.aliasFor = childAlias;\n\n                if (label.position === INSIDE && !defined(size)) {\n                    if (icon.type === CIRCLE) {\n                        size = Math.max(this.label.box.width(), this.label.box.height());\n                    } else {\n                        width = this.label.box.width();\n                        height = this.label.box.height();\n                    }\n                    box.wrap(this.label.box);\n                }\n            }\n\n            icon.width = width || size || DEFAULT_ICON_SIZE;\n            icon.height = height || size || DEFAULT_ICON_SIZE;\n\n            var marker = new ShapeElement(deepExtend({}, icon));\n            marker.aliasFor = childAlias;\n\n            this.marker = marker;\n            this.append(marker);\n\n            if (this.label) {\n                this.append(this.label);\n            }\n\n            marker.reflow(new Box());\n            this.wrapperBox = box.wrap(marker.box);\n        }\n    };\n\n    Note.prototype.reflow = function reflow (targetBox) {\n        var ref = this;\n        var options = ref.options;\n        var label = ref.label;\n        var marker = ref.marker;\n        var wrapperBox = ref.wrapperBox;\n        var center = targetBox.center();\n        var length = options.line.length;\n        var position = options.position;\n\n        // TODO: Review\n        if (options.visible) {\n            var lineStart, box, contentBox;\n\n            if (inArray(position, [ LEFT, RIGHT ])) {\n                if (position === LEFT) {\n                    contentBox = wrapperBox.alignTo(targetBox, position).translate(-length, targetBox.center().y - wrapperBox.center().y);\n\n                    if (options.line.visible) {\n                        lineStart = [ targetBox.x1, center.y ];\n                        this.linePoints = [\n                            lineStart,\n                            [ contentBox.x2, center.y ]\n                        ];\n                        box = contentBox.clone().wrapPoint(lineStart);\n                    }\n                } else {\n                    contentBox = wrapperBox.alignTo(targetBox, position).translate(length, targetBox.center().y - wrapperBox.center().y);\n\n                    if (options.line.visible) {\n                        lineStart = [ targetBox.x2, center.y ];\n                        this.linePoints = [\n                            lineStart,\n                            [ contentBox.x1, center.y ]\n                        ];\n                        box = contentBox.clone().wrapPoint(lineStart);\n                    }\n                }\n            } else {\n                if (position === BOTTOM) {\n                    contentBox = wrapperBox.alignTo(targetBox, position).translate(targetBox.center().x - wrapperBox.center().x, length);\n\n                    if (options.line.visible) {\n                        lineStart = [ center.x, targetBox.y2 ];\n                        this.linePoints = [\n                            lineStart,\n                            [ center.x, contentBox.y1 ]\n                        ];\n                        box = contentBox.clone().wrapPoint(lineStart);\n                    }\n                } else {\n                    contentBox = wrapperBox.alignTo(targetBox, position).translate(targetBox.center().x - wrapperBox.center().x, -length);\n\n                    if (options.line.visible) {\n                        lineStart = [ center.x, targetBox.y1 ];\n                        this.linePoints = [\n                            lineStart,\n                            [ center.x, contentBox.y2 ]\n                        ];\n                        box = contentBox.clone().wrapPoint(lineStart);\n                    }\n                }\n            }\n\n            if (marker) {\n                marker.reflow(contentBox);\n            }\n\n            if (label) {\n                label.reflow(contentBox);\n                if (marker) {\n                    if (options.label.position === OUTSIDE) {\n                        label.box.alignTo(marker.box, position);\n                    }\n                    label.reflow(label.box);\n                }\n            }\n\n            this.contentBox = contentBox;\n            this.targetBox = targetBox;\n            this.box = box || contentBox;\n        }\n    };\n\n    Note.prototype.createVisual = function createVisual () {\n        BoxElement.prototype.createVisual.call(this);\n        this.visual.options.noclip = this.options.noclip;\n\n        if (this.options.visible) {\n            this.createLine();\n        }\n    };\n\n    Note.prototype.renderVisual = function renderVisual () {\n        var this$1 = this;\n\n        var options = this.options;\n        var customVisual = options.visual;\n        if (options.visible && customVisual) {\n            this.visual = customVisual(Object.assign(this.fields, {\n                sender: this.getSender(),\n                rect: this.targetBox.toRect(),\n                options: {\n                    background: options.background,\n                    border: options.background,\n                    icon: options.icon,\n                    label: options.label,\n                    line: options.line,\n                    position: options.position,\n                    visible: options.visible\n                },\n                createVisual: function () {\n                    this$1.createVisual();\n                    this$1.renderChildren();\n                    var defaultVisual = this$1.visual;\n                    delete this$1.visual;\n                    return defaultVisual;\n                }\n            }));\n            this.addVisual();\n        } else {\n            BoxElement.prototype.renderVisual.call(this);\n        }\n    };\n\n    Note.prototype.createLine = function createLine () {\n        var options = this.options.line;\n\n        if (this.linePoints) {\n            var path = draw.Path.fromPoints(this.linePoints, {\n                stroke: {\n                    color: options.color,\n                    width: options.width,\n                    dashType: options.dashType\n                }\n            });\n\n            alignPathToPixel(path);\n            this.visual.append(path);\n        }\n    };\n\n    Note.prototype.click = function click (widget, e) {\n        var args = this.eventArgs(e);\n\n        if (!widget.trigger(NOTE_CLICK, args)) {\n            e.preventDefault();\n        }\n    };\n\n    Note.prototype.over = function over (widget, e) {\n        var args = this.eventArgs(e);\n\n        if (!widget.trigger(NOTE_HOVER, args)) {\n            e.preventDefault();\n        }\n    };\n\n    Note.prototype.out = function out (widget, e) {\n        var args = this.eventArgs(e);\n\n        widget.trigger(NOTE_LEAVE, args);\n    };\n\n    Note.prototype.eventArgs = function eventArgs (e) {\n        var options = this.options;\n\n        return Object.assign(this.fields, {\n            element: eventElement(e),\n            text: defined(options.label) ? options.label.text : \"\",\n            visual: this.visual\n        });\n    };\n\n    return Note;\n}(BoxElement));\n\nsetDefaultOptions(Note, {\n    icon: {\n        visible: true,\n        type: CIRCLE\n    },\n    label: {\n        position: INSIDE,\n        visible: true,\n        align: CENTER,\n        vAlign: CENTER\n    },\n    line: {\n        visible: true\n    },\n    visible: true,\n    position: TOP,\n    zIndex: 2\n});\n\nexport default Note;"]},"metadata":{},"sourceType":"module"}